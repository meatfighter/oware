(()=>{"use strict";var e={839:(e,t,s)=>{var n,i,a;s.d(t,{J5:()=>n,Jq:()=>i,OF:()=>r,qW:()=>a}),function(e){e[e.A=1]="A",e[e.B=-1]="B"}(n||(n={})),function(e){e[e.INTERMEDIATE=0]="INTERMEDIATE",e[e.DRAW=1]="DRAW",e[e.A_WON=2]="A_WON",e[e.B_WON=3]="B_WON"}(i||(i={})),function(e){e[e.RESET=0]="RESET",e[e.SOWED=1]="SOWED",e[e.CAPTURED_REMAINDER=2]="CAPTURED_REMAINDER"}(a||(a={}));class r{static PERMUTATIONS=[];static{!function e(t=[],s=0,n=new Array(6).fill(!1)){if(6===s)r.PERMUTATIONS.push(t.slice());else for(let i=0;i<6;++i)n[i]||(n[i]=!0,t[s]=i,e(t,s+1,n),n[i]=!1)}()}parent;houses;scoreA;scoreB;hash;type;heuristicValue;createPlayer;createOperation;createSownHouse;createCaptured;constructor(e=null){null===e?(this.parent=null,this.houses=new Array(12).fill(4),this.scoreA=0,this.scoreB=0,this.hash=0,this.type=i.INTERMEDIATE,this.heuristicValue=0,this.createPlayer=n.B,this.createOperation=a.RESET,this.createSownHouse=-1,this.createCaptured=!1):(this.parent=e,this.houses=e.houses.slice(),this.scoreA=e.scoreA,this.scoreB=e.scoreB,this.hash=e.hash,this.type=e.type,this.heuristicValue=e.heuristicValue,this.createPlayer=e.createPlayer,this.createOperation=e.createOperation,this.createSownHouse=e.createSownHouse,this.createCaptured=e.createCaptured)}children(){if(this.type!==i.INTERMEDIATE)return[];const e=this.createPlayer===n.B?0:6,t=[],s=r.PERMUTATIONS[Math.floor(Math.random()*r.PERMUTATIONS.length)];for(let n=5;n>=0;--n){const i=this.attemptSow(e+s[n]);null!==i&&t.push(i)}if(0===t.length){const e=new r(this);e.createPlayer=-this.createPlayer,e.createOperation=a.CAPTURED_REMAINDER,e.createSownHouse=-1,e.createCaptured=!1;for(let t=11;t>=6;--t)e.scoreB+=e.houses[t],e.houses[t]=0;for(let t=5;t>=0;--t)e.scoreA+=e.houses[t],e.houses[t]=0;e.determineHashTypeAndHeuristicValue(),t.push(e)}else this.createPlayer===n.A?t.sort(((e,t)=>e.heuristicValue-t.heuristicValue)):t.sort(((e,t)=>t.heuristicValue-e.heuristicValue));return t}attemptSow(e){if(0===this.houses[e])return null;const t=new r(this);t.createPlayer=-this.createPlayer,t.createOperation=a.SOWED,t.createSownHouse=e,t.createCaptured=!1;let s=t.houses[e];t.houses[e]=0;let i=e;for(;s>0;)++i>11&&(i=0),i===e&&++i>11&&(i=0),--s,++t.houses[i];if(t.createPlayer===n.A){if(i>=6){for(;i>=6&&(2===t.houses[i]||3===t.houses[i]);)t.houses[i]=-t.houses[i],--i;let e=0;for(let s=11;s>=6;--s)t.houses[s]<=0&&++e;if(6===e)for(let e=11;e>=6;--e)t.houses[e]<0&&(t.houses[e]=-t.houses[e]);else for(let e=11;e>=6;--e)t.houses[e]<0&&(t.scoreA-=t.houses[e],t.houses[e]=0,t.createCaptured=!0)}for(let e=11;e>=6;--e)if(0!==t.houses[e])return t.determineHashTypeAndHeuristicValue(),t.checkThreefoldRepetition(),t}else{if(i<6){for(;i>=0&&(2===t.houses[i]||3===t.houses[i]);)t.houses[i]=-t.houses[i],--i;let e=0;for(let s=5;s>=0;--s)t.houses[s]<=0&&++e;if(6===e)for(let e=5;e>=0;--e)t.houses[e]<0&&(t.houses[e]=-t.houses[e]);else for(let e=5;e>=0;--e)t.houses[e]<0&&(t.scoreB-=t.houses[e],t.houses[e]=0,t.createCaptured=!0)}for(let e=5;e>=0;--e)if(0!==t.houses[e])return t.determineHashTypeAndHeuristicValue(),t.checkThreefoldRepetition(),t}return null}checkThreefoldRepetition(){e:{for(let e=11;e>=6;--e)if(this.houses[e]>0)break e;return}e:{for(let e=5;e>=0;--e)if(this.houses[e]>0)break e;return}let e=this.parent,t=0;for(;null!==e&&e.scoreA===this.scoreA&&e.scoreB===this.scoreB;){e:if(e.createPlayer===this.createPlayer&&e.hash===this.hash){for(let t=11;t>=0;--t)if(e.houses[t]!==this.houses[t])break e;if(3==++t){this.createOperation=a.CAPTURED_REMAINDER;for(let e=11;e>=6;--e)this.scoreB+=this.houses[e];for(let e=5;e>=0;--e)this.scoreA+=this.houses[e];return void this.determineHashTypeAndHeuristicValue()}}e=e.parent}}determineHashTypeAndHeuristicValue(){const e=this.scoreA<<24|this.houses[3]<<18|this.houses[2]<<12|this.houses[1]<<6|this.houses[0],t=this.scoreB<<25|this.houses[7]<<19|this.houses[6]<<13|this.houses[5]<<7|this.houses[4]<<1,s=this.houses[11]<<21|this.houses[10]<<15|this.houses[9]<<9|this.houses[8]<<3;this.hash=e^t^s,this.heuristicValue=200*(this.scoreA-this.scoreB),24===this.scoreA&&24===this.scoreB?this.type=i.DRAW:this.scoreA>24?(this.type=i.A_WON,this.heuristicValue+=1e4):this.scoreB>24?(this.type=i.B_WON,this.heuristicValue-=1e4):this.type=i.INTERMEDIATE;for(let e=11;e>=6;--e)switch(this.houses[e]){case 0:this.heuristicValue+=10;break;case 1:this.heuristicValue+=20;break;case 2:this.heuristicValue+=30}for(let e=5;e>=0;--e)switch(this.houses[e]){case 0:this.heuristicValue-=10;break;case 1:this.heuristicValue-=20;break;case 2:this.heuristicValue-=30}for(let e=10;e>=6;--e)this.houses[e]<=2&&this.houses[e+1]<=2&&++this.heuristicValue;for(let e=4;e>=0;--e)this.houses[e]<=2&&this.houses[e+1]<=2&&--this.heuristicValue}pad(e){return e<10?`0${e}`:`${e}`}toString(){return`   ${this.pad(this.houses[11])} ${this.pad(this.houses[10])} ${this.pad(this.houses[9])} ${this.pad(this.houses[8])} ${this.pad(this.houses[7])} ${this.pad(this.houses[6])}\n${this.pad(this.scoreB)}                   ${this.pad(this.scoreA)}\n   ${this.pad(this.houses[0])} ${this.pad(this.houses[1])} ${this.pad(this.houses[2])} ${this.pad(this.houses[3])} ${this.pad(this.houses[4])} ${this.pad(this.houses[5])}`}}},468:(e,t,s)=>{s.d(t,{V1:()=>I,Cs:()=>c,G$:()=>d,sS:()=>A});var n=s(839);class i{cancelled=!1}const a=1e5;class r{value=0;bestChild=null;outcome=n.Jq.INTERMEDIATE}var o;!function(e){e[e.ENTERED=0]="ENTERED",e[e.BEFORE=1]="BEFORE",e[e.AFTER=2]="AFTER"}(o||(o={}));class u{node=new n.OF;alpha=0;beta=0;children=[];value=0;bestChild=null;outcome=n.Jq.INTERMEDIATE;i=0;state=o.ENTERED}const l=new Array(32).fill(null).map((()=>new u));async function h(e,t,s){const i=l[t];i.node=e,i.alpha=-1/0,i.beta=1/0,await async function(e,t){const s=e;l[e].state=o.ENTERED;let i=a;for(;e<=s&&(0!=--i||(i=a,await new Promise((e=>setTimeout(e,0))),!t.cancelled));){const t=l[e];switch(t.state){case o.ENTERED:if(0===e||t.node.type!==n.Jq.INTERMEDIATE){t.value=-t.node.createPlayer*t.node.heuristicValue,t.outcome=t.node.type,t.bestChild=null,++e;continue}t.children=t.node.children(),t.value=-1/0,t.bestChild=null,t.outcome=n.Jq.INTERMEDIATE,t.i=0,t.state=o.BEFORE;break;case o.BEFORE:{if(t.i===t.children.length){++e;continue}const s=l[--e];s.node=t.children[t.i++],t.state=o.AFTER,s.state=o.ENTERED,s.alpha=-t.beta,s.beta=-t.alpha;break}case o.AFTER:{const s=l[e-1];if(-s.value>t.value&&(t.value=-s.value,t.bestChild=s.node,t.outcome=s.outcome),t.alpha=Math.max(t.alpha,t.value),t.alpha>=t.beta){++e;continue}t.state=o.BEFORE;break}}}}(t,s);const u=new r;return u.bestChild=i.bestChild,u.value=i.value,u.outcome=i.outcome,u}var c;!function(e){e[e.SEARCH_MANY=0]="SEARCH_MANY",e[e.SEARCH_NARROW=1]="SEARCH_NARROW",e[e.SEARCH_RESPONSE=2]="SEARCH_RESPONSE",e[e.CANCEL_ALL=3]="CANCEL_ALL"}(c||(c={}));class d{type=c.SEARCH_MANY;requestID;nodes;depth;constructor(e,t,s){this.requestID=e,this.nodes=t,this.depth=s}}class A{type=c.SEARCH_NARROW;requestID;nodeIndex;constructor(e,t){this.nodeIndex=t,this.requestID=e}}class I{type=c.CANCEL_ALL}class E{type=c.SEARCH_RESPONSE;results;requestID;constructor(e,t){this.results=e,this.requestID=t}}class D{searchManyRequest;canceller=new i;cancelled;results;nodeIndex=0;constructor(e){this.searchManyRequest=e,this.cancelled=new Array(e.nodes.length).fill(!1),this.results=new Array(e.nodes.length).fill(null)}}const p=[];let R=!1;onmessage=async e=>{const t=e.data;switch(t.type){case c.SEARCH_MANY:await async function(e){if(function(e){if(0===e.length)return;let t=function(e){let t=null,s=null;for(;null!==e.parent;)if(e=e.parent,null===s)s=t=new n.OF(e),s.parent=null;else{const t=new n.OF(e);t.parent=null,s.parent=t,s=t}return t}(e[0]);for(let s=e.length-1;s>=0;--s)e[s]=new n.OF(e[s]),e[s].parent=t}(e.nodes),p.push(new D(e)),!R){for(R=!0;p.length>0;){const e=p[0];if(e.nodeIndex<e.searchManyRequest.nodes.length){if(e.canceller.cancelled=!1,e.cancelled[e.nodeIndex])e.results[e.nodeIndex]=null;else{const t=await h(e.searchManyRequest.nodes[e.nodeIndex],e.searchManyRequest.depth,e.canceller);t&&t.bestChild&&!e.cancelled[e.nodeIndex]?(t.bestChild.parent=null,e.results[e.nodeIndex]=t):e.results[e.nodeIndex]=null}++e.nodeIndex}else{p.shift();for(let t of e.cancelled)if(!t){postMessage(new E(e.results,e.searchManyRequest.requestID));break}}}R=!1}}(t);break;case c.SEARCH_NARROW:!function(e){for(let t of p)if(t.searchManyRequest.requestID===e.requestID){t.nodeIndex!==e.nodeIndex&&(t.canceller.cancelled=!0);for(let s=t.cancelled.length-1;s>=0;--s)t.cancelled[s]=s!==e.nodeIndex}}(t);break;case c.CANCEL_ALL:!function(){for(let e of p){e.canceller.cancelled=!0;for(let t=e.cancelled.length-1;t>=0;--t)e.cancelled[t]=!0}}()}}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,s),a.exports}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{s.d(n,{uc:()=>Ue,MG:()=>Le,uJ:()=>qe,ln:()=>Ve});var e=s(839);const t=1,i=19;let a=e.J5.A,r=t,o=!1;function u(){document.getElementById("main-content").innerHTML=`\n            <div id="start-div">\n                <div id="level-div">\n                    <button id="minus-button">&minus;</button>\n                    <span id="level-span" class="no-wrap">Level ${r}</span>\n                    <button id="plus-button">&plus;</button>\n                </div>\n                <div id="first-player-div">\n                    <input type="radio" id="human-radio" name="first-player" value="human" \n                            ${a===e.J5.A?"checked":""}>\n                    <label for="human-radio" class="no-wrap">Human First</label>                \n                    <input type="radio" id="ai-radio" name="first-player" value="ai"\n                            ${a===e.J5.B?"checked":""}>\n                    <label for="ai-radio" class="no-wrap">AI First</label>\n                </div>\n                <div id="go-div">\n                    <button id="start-button">Start</button>\n                </div>\n            </div>`,document.getElementById("minus-button").addEventListener("click",(e=>{r>t&&(--r,l())})),document.getElementById("plus-button").addEventListener("click",(e=>{r<i&&(++r,l())})),document.getElementById("human-radio").addEventListener("click",(t=>{a=e.J5.A})),document.getElementById("ai-radio").addEventListener("click",(t=>{a=e.J5.B})),document.getElementById("start-button").addEventListener("click",(e=>{Ve(a,r)})),l(),h()}function l(){const e=document.getElementById("minus-button"),s=document.getElementById("plus-button"),n=document.getElementById("level-span");if(n.style.width="",n.style.display="inline-block",n.style.textAlign="center",n.textContent="Level 00",o){const e=n.getBoundingClientRect().width;n.style.width=`${e}px`}else{const e=n.getBoundingClientRect().height;n.style.width=`${e}px`}n.textContent=`Level ${r}`,e.disabled=r===t,s.disabled=r===i}function h(){const e=document.getElementById("start-div"),t=document.getElementById("minus-button"),s=document.getElementById("plus-button");t.style.width=s.style.width=e.style.top=e.style.left=e.style.transform="",e.style.display="none";const n=window.innerWidth,i=window.innerHeight;if(o=n>=i,e.style.display="flex",t.style.width=s.style.width=`${s.getBoundingClientRect().width}px`,o){const t=e.getBoundingClientRect();e.style.left=(n-t.width)/2+"px",e.style.top=(i-t.height)/2+"px"}else{e.style.transform="rotate(-90deg)";const t=e.getBoundingClientRect();e.style.left=(n-t.height)/2+"px",e.style.top=(i-t.width)/2+"px"}l()}class c{x;y;constructor(e,t){this.x=e,this.y=t}}const d=(()=>{const e=new Array(49).fill(null).map((()=>[])),t=atob("AAAAAAAAAAAAAAgAAAAAIAAAAAIAACAACAACAAAiAAAAIgAAIgAIACIAACIAIgAiAAAiACoAIgAAIggiCCIAACoAqgAqAACqAFUAqgAA1QCqANUAgFWAVYBVgFUAQQhBAFWqAFUA1QCq1QCqANUA1dUA1QDVANXVANUI1QDV1SDVANUC1dUg1QjVAtVVolWAVSLV1SLVCNUi1dUi1SLVItXVItUq1SLVVSpVIlUqVQ==");for(let s=0;s<49;++s){const n=e[s];let i,a;s<=24?(i=s,a=0):(i=49-s,a=255),i*=7;for(let e=0;e<7;++e){let s=a^t.charCodeAt(i+e);for(let t=0;t<7;++t,s>>=1)1==(1&s)&&n.push(new c(t,e))}}return e})(),A=1e3/60,I=5;let E=!1,D=0,p=0,R=0;function f(){E||(E=!0,R=0,D=requestAnimationFrame(N),p=performance.now())}function T(){E&&(E=!1,cancelAnimationFrame(D))}function N(){if(!E)return;D=requestAnimationFrame(N),Fe();const e=performance.now(),t=e-p;p=e,R+=t;let s=0;for(;R>=A&&E;)if(_e(),R-=A,++s>I){R=0,p=performance.now();break}}const _=500/A,F=1/_;var H;!function(e){e.BROWN="#C3986F",e.CYAN="#00B9BA",e.DARK_GRAY="#1E1F22",e.LIGHT_CYAN="#4DFFFF",e.LIGHT_GRAY="#BCBEC4",e.LIGHT_MAGENTA="#FFA9FF",e.MAGENTA="#FF32FF"}(H||(H={}));const S=q(H.MAGENTA,H.LIGHT_MAGENTA,64),g=q(H.BROWN,H.MAGENTA,64),y=q(H.CYAN,H.LIGHT_CYAN,64),G=q(H.BROWN,H.CYAN,64);var O,C,m,W,w,b,M;!function(e){e[e.SIZE=100]="SIZE",e[e.PADDING=15]="PADDING",e[e.RADIUS=20]="RADIUS"}(O||(O={})),function(e){e[e.RADIUS=6.25]="RADIUS",e[e.DIAMETER=12.5]="DIAMETER"}(C||(C={})),function(e){e[e.WIDTH=18]="WIDTH",e[e.BAR_HEIGHT=2]="BAR_HEIGHT",e[e.PADDING=5]="PADDING",e[e.HEIGHT=12]="HEIGHT"}(m||(m={})),function(e){e[e.RADIUS=12.5]="RADIUS",e[e.DIAMETER=25]="DIAMETER"}(W||(W={})),function(e){e[e.SIZE=12.5]="SIZE",e[e.PADDING=9.375]="PADDING"}(w||(w={})),function(e){e[e.WIDTH=56.25]="WIDTH",e[e.HEIGHT=12.5]="HEIGHT"}(b||(b={})),function(e){e[e.WIDTH=905]="WIDTH",e[e.HEIGHT=215]="HEIGHT"}(M||(M={}));const v=function(e,t,s,n,i){const a=new Path2D;return a.roundRect(0,0,s,n,i),a}(0,0,O.SIZE,O.SIZE,O.RADIUS),P=J(C.RADIUS),B=function(){const e=new Path2D;return e.rect(0,0,m.WIDTH,m.BAR_HEIGHT),e.rect(0,m.PADDING,m.WIDTH,m.BAR_HEIGHT),e.rect(0,2*m.PADDING,m.WIDTH,m.BAR_HEIGHT),e}(),k=J(W.RADIUS),V=function(e){const t=new Path2D;return t.arc(0,0,e,Math.PI,2*Math.PI),t}(W.RADIUS),U=function(){const e=new Array(4).fill(null).map((()=>new Path2D)),t=-(3*w.SIZE+2*w.PADDING)/2;for(let s=3;s>=0;--s)for(let n=s;n>0;--n)e[s].rect(t+(n-1)*(w.SIZE+w.PADDING),0,w.SIZE,w.SIZE);return e}(),L=function(){const e=new Path2D;return e.rect(-b.WIDTH/2,0,b.WIDTH,b.HEIGHT),e}();function q(e,t,s){const n=Z(e),i=Z(t),a=[i[0]-n[0],i[1]-n[1],i[2]-n[2]],r=new Array(s);for(let e=s-1;e>=0;--e){const t=e/(s-1);r[e]=`#${x((o=[n[0]+t*a[0],n[1]+t*a[1],n[2]+t*a[2]])[0])}${x(o[1])}${x(o[2])}`}var o;return r}function x(e){return Math.max(0,Math.min(255,Math.round(e))).toString(16).padStart(2,"0").toUpperCase()}function Z(e){return[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)]}function J(e){const t=new Path2D;return t.arc(0,0,e,0,2*Math.PI),t}class ${seeds=0;gradient=G;gradientFrac=0;updater=null}var Y;!function(e){e[e.INTERMEDIATE=0]="INTERMEDIATE",e[e.A_FAVORED=1]="A_FAVORED",e[e.B_FAVORED=2]="B_FAVORED",e[e.DRAW_FAVORED=3]="DRAW_FAVORED",e[e.A_WON=4]="A_WON",e[e.B_WON=5]="B_WON",e[e.DRAW=6]="DRAW"}(Y||(Y={}));const Q=100/A;var j;!function(e){e[e.SOWING=0]="SOWING",e[e.CAPTURING=1]="CAPTURING",e[e.WAITING_FOR_MOVE_FADE=2]="WAITING_FOR_MOVE_FADE",e[e.WAITING_FOR_CLEAR_FADE=3]="WAITING_FOR_CLEAR_FADE",e[e.FINISHED_CLEAR_FADE=4]="FINISHED_CLEAR_FADE",e[e.DONE=5]="DONE"}(j||(j={}));class K{board;player;timer;seeds;currentHouse;sourceHouse;capture;moveDone;waitForMoveFade;updatesDone;state;constructor(t,s,n,i,a,r){this.board=t,this.player=s,this.sourceHouse=n,this.capture=i,this.moveDone=a,this.waitForMoveFade=r,this.updatesDone=null,this.state=j.SOWING;const o=this.board.houseStates[n];this.currentHouse=n+1,this.currentHouse>11&&(this.currentHouse=0),this.seeds=o.seeds,o.seeds=0,o.gradient=s===e.J5.A?y:S,o.gradientFrac=1,o.updater=this,this.timer=_}set updatesDoneCallback(e){this.updatesDone=e}update(){switch(this.state){case j.SOWING:this.updateSow();break;case j.CAPTURING:this.updateCapture();break;case j.WAITING_FOR_MOVE_FADE:this.updateWaitingForMoveFade();break;case j.WAITING_FOR_CLEAR_FADE:this.updateWaitingForClearFade();break;case j.FINISHED_CLEAR_FADE:this.updateFinishedClearFade()}}updateSow(){if(this.timer>0)return void--this.timer;const t=this.board.houseStates[this.currentHouse];++t.seeds,t.gradient=this.player===e.J5.A?y:S,t.gradientFrac=1,t.updater=this,this.timer=Q,--this.seeds>0?(++this.currentHouse>11&&(this.currentHouse=0),this.currentHouse===this.sourceHouse&&++this.currentHouse>11&&(this.currentHouse=0)):this.capture?(this.timer=_,this.state=j.CAPTURING):this.state=j.WAITING_FOR_MOVE_FADE}updateCapture(){if(this.timer>0)return void--this.timer;const t=this.board.houseStates[this.currentHouse],s=this.board.houseStates[this.player===e.J5.A?12:13];if(s.seeds+=t.seeds,t.seeds=0,t.gradient=s.gradient=this.player===e.J5.A?y:S,t.gradientFrac=s.gradientFrac=1,s.updater=t.updater=this,this.timer=Q,--this.currentHouse<(this.player===e.J5.A?6:0))this.state=j.WAITING_FOR_MOVE_FADE;else{const e=this.board.houseStates[this.currentHouse];(e.seeds<2||e.seeds>3)&&(this.state=j.WAITING_FOR_MOVE_FADE)}}isFadeCompleted(){for(let e=13;e>=0;--e){const t=this.board.houseStates[e];if(t.updater===this&&t.gradientFrac>0)return!1}return!0}updateWaitingForMoveFade(){if(this.moveDone&&!this.waitForMoveFade&&(this.moveDone(),this.moveDone=null),this.isFadeCompleted()){for(let e=13;e>=0;--e){const t=this.board.houseStates[e];t.updater===this&&(t.gradient===y?(t.gradient=G,t.gradientFrac=1):t.gradient===S&&(t.gradient=g,t.gradientFrac=1))}this.state=j.WAITING_FOR_CLEAR_FADE,this.moveDone&&(this.moveDone(),this.moveDone=null)}}updateWaitingForClearFade(){this.isFadeCompleted()&&(this.state=j.FINISHED_CLEAR_FADE)}updateFinishedClearFade(){for(let e=13;e>=0;--e){const t=this.board.houseStates[e];t.updater===this&&(t.updater=null)}this.updatesDone&&(this.updatesDone(),this.updatesDone=null)}}const X=100/A;var z;!function(e){e[e.WAITING_FOR_FADE=0]="WAITING_FOR_FADE",e[e.CAPTURING=1]="CAPTURING",e[e.WAITING_FOR_CAPTURE_FADE=2]="WAITING_FOR_CAPTURE_FADE",e[e.WAITING_FOR_CLEAR_FADE=3]="WAITING_FOR_CLEAR_FADE",e[e.FINISHED_CLEAR_FADE=4]="FINISHED_CLEAR_FADE",e[e.DONE=5]="DONE"}(z||(z={}));class ee{board;player;timer;scoreHouseState;currentHouse;state;capturesDone;updatesDone;constructor(t,s,n){for(this.board=t,this.player=s,this.timer=_,this.scoreHouseState=t.houseStates[s===e.J5.A?12:13],this.capturesDone=n,this.updatesDone=null,this.currentHouse=s===e.J5.A?0:6;;){if(this.currentHouse>(this.player===e.J5.A?5:11)){this.state=z.FINISHED_CLEAR_FADE;break}if(this.board.houseStates[this.currentHouse].seeds>0){this.state=z.CAPTURING;break}++this.currentHouse}}set updatesDoneCallback(e){this.updatesDone=e}update(){switch(this.state){case z.CAPTURING:this.updateCapture();break;case z.WAITING_FOR_CAPTURE_FADE:this.updateWaitingForCaptureFade();break;case z.WAITING_FOR_CLEAR_FADE:this.updateWaitingForClearFade();break;case z.FINISHED_CLEAR_FADE:this.updateFinishedClearFade()}}updateCapture(){if(this.timer>0)return void--this.timer;const t=this.board.houseStates[this.currentHouse];for(this.scoreHouseState.seeds+=t.seeds,t.seeds=0,this.scoreHouseState.gradient=t.gradient=this.player===e.J5.A?y:S,this.scoreHouseState.gradientFrac=t.gradientFrac=1,this.scoreHouseState.updater=t.updater=this;;){if(this.currentHouse>(this.player===e.J5.A?5:11))return void(this.state=z.WAITING_FOR_CAPTURE_FADE);if(this.board.houseStates[this.currentHouse].seeds>0)break;++this.currentHouse}this.timer=X}updateWaitingForCaptureFade(){if(this.capturesDone&&(this.capturesDone(),this.capturesDone=null),this.isFadeCompleted()){for(let e=13;e>=0;--e){const t=this.board.houseStates[e];t.updater===this&&(t.gradient===y?(t.gradient=G,t.gradientFrac=1):t.gradient===S&&(t.gradient=g,t.gradientFrac=1))}this.state=z.WAITING_FOR_CLEAR_FADE}}isFadeCompleted(){for(let e=13;e>=0;--e){const t=this.board.houseStates[e];if(t.updater===this&&t.gradientFrac>0)return!1}return!0}updateWaitingForClearFade(){this.isFadeCompleted()&&(this.state=z.FINISHED_CLEAR_FADE)}updateFinishedClearFade(){for(let e=13;e>=0;--e){const t=this.board.houseStates[e];t.updater===this&&(t.updater=null)}this.capturesDone&&(this.capturesDone(),this.capturesDone=null),this.updatesDone&&(this.updatesDone(),this.updatesDone=null)}}const te=1e3/A,se=500/A;var ne;!function(e){e[e.WAITING_TO_APPEAR=0]="WAITING_TO_APPEAR",e[e.DOTTING=1]="DOTTING",e[e.FINISHING=2]="FINISHING",e[e.DONE=3]="DONE"}(ne||(ne={}));class ie{board;thinkingDone;timer;state;constructor(e){this.board=e,this.thinkingDone=null,this.timer=te,this.state=ne.WAITING_TO_APPEAR,e.thinkingIndex=0}set thinkingDoneCallback(e){this.thinkingDone=e}stop(){this.state=ne.FINISHING,this.board.thinkingIndex=0}update(){switch(this.state){case ne.WAITING_TO_APPEAR:this.updateWaitToAppear();break;case ne.DOTTING:this.updateDots();break;case ne.FINISHING:this.updateFinish()}}updateWaitToAppear(){this.timer>0?--this.timer:this.state=ne.DOTTING}updateDots(){this.timer>0?--this.timer:(++this.board.thinkingIndex>3&&(this.board.thinkingIndex=0),this.timer=se)}updateFinish(){this.state=ne.DONE,this.thinkingDone&&(this.thinkingDone(),this.thinkingDone=null)}}var ae,re=s(468);!function(e){e[e.WAITING_FOR_HUMAN=0]="WAITING_FOR_HUMAN",e[e.HUMAN_SOWING=1]="HUMAN_SOWING",e[e.WAITING_FOR_AI=2]="WAITING_FOR_AI",e[e.AI_SOWING=3]="AI_SOWING",e[e.CAPTURING_REMAINDER=4]="CAPTURING_REMAINDER",e[e.GAME_OVER=5]="GAME_OVER"}(ae||(ae={}));const oe=new class{houseStates=new Array(14).fill(null).map((()=>new $));status=Y.INTERMEDIATE;thinkingIndex=0;fadesDone=!1;constructor(){this.reset()}reset(){for(let e=13;e>=0;--e){const t=this.houseStates[e];t.seeds=e>11?0:4,t.gradient=G,t.gradientFrac=0}this.status=Y.INTERMEDIATE,this.thinkingIndex=0}updateFades(){let e=!0;for(let t=13;t>=0;--t){const s=this.houseStates[t];s.gradientFrac>0&&(e=!1,s.gradientFrac=Math.max(0,s.gradientFrac-F))}const t=e&&this.fadesDone;return this.fadesDone=e,t}render(e){e.fillStyle=H.DARK_GRAY,e.fillRect(0,0,M.WIDTH,M.HEIGHT);for(let t=13;t>=0;--t){const s=this.houseStates[t];let n,i;t<6?(n=(O.SIZE+O.PADDING)*(t+1),i=O.SIZE+O.PADDING):t<12?(n=(O.SIZE+O.PADDING)*(12-t),i=0):12===t?(n=7*(O.SIZE+O.PADDING),i=(M.HEIGHT-O.SIZE)/2):(n=0,i=(M.HEIGHT-O.SIZE)/2),e.save(),e.fillStyle=s.gradient[Math.round(63*s.gradientFrac)],e.translate(n,i),e.fill(v),e.fillStyle=H.DARK_GRAY;for(let t of d[s.seeds])e.save(),e.translate(C.DIAMETER+C.DIAMETER*t.x,C.DIAMETER+C.DIAMETER*t.y),e.fill(P),e.restore();e.restore()}e.fillStyle=H.LIGHT_GRAY,e.save(),e.translate((O.SIZE-m.WIDTH)/2,((M.HEIGHT-O.SIZE)/2-m.HEIGHT)/2),e.fill(B),e.restore(),this.status===Y.B_WON?(e.fillStyle=H.BROWN,e.save(),e.translate(O.SIZE/2,(M.HEIGHT-O.SIZE)/2+O.SIZE+O.PADDING+W.RADIUS),e.fill(k),e.restore()):this.status===Y.A_WON?(e.fillStyle=H.BROWN,e.save(),e.translate(7*(O.SIZE+O.PADDING)+O.SIZE/2,(M.HEIGHT-O.SIZE)/2+O.SIZE+O.PADDING+W.RADIUS),e.fill(k),e.restore()):this.status===Y.DRAW?(e.fillStyle=H.BROWN,e.save(),e.translate(O.SIZE/2,(M.HEIGHT-O.SIZE)/2+O.SIZE+O.PADDING+W.RADIUS),e.fill(V),e.restore(),e.save(),e.translate(7*(O.SIZE+O.PADDING)+O.SIZE/2,(M.HEIGHT-O.SIZE)/2+O.SIZE+O.PADDING+W.RADIUS),e.fill(V),e.restore()):(this.status!==Y.B_FAVORED&&this.status!==Y.DRAW_FAVORED||(e.fillStyle=H.BROWN,e.save(),e.translate(O.SIZE/2,(M.HEIGHT-O.SIZE)/2+O.SIZE+O.PADDING),e.fill(L),e.restore()),this.status!==Y.A_FAVORED&&this.status!==Y.DRAW_FAVORED||(e.fillStyle=H.BROWN,e.save(),e.translate(7*(O.SIZE+O.PADDING)+O.SIZE/2,(M.HEIGHT-O.SIZE)/2+O.SIZE+O.PADDING),e.fill(L),e.restore())),this.thinkingIndex>0&&(e.fillStyle=H.BROWN,e.save(),e.translate(O.SIZE/2,(M.HEIGHT-O.SIZE)/2+O.SIZE+2*O.PADDING+b.HEIGHT),e.fill(U[this.thinkingIndex]),e.restore())}},ue=[];let le,he=ae.WAITING_FOR_HUMAN,ce=new e.OF,de=0,Ae=0,Ie=null,Ee=null,De=null;const pe=new Worker("scripts/worker.bundle.js");let Re,fe;function Te(){document.getElementById("main-content").innerHTML='<canvas id="oware-canvas" class="canvas" width="1" height="1"></canvas>',Re=document.getElementById("oware-canvas"),Re&&(Re.addEventListener("click",(e=>{if(!Re)return;const t=Re.getBoundingClientRect(),s=e.clientX-t.left,n=e.clientY-t.top,i=window.devicePixelRatio||1,a=Math.floor(Re.width/i),r=Math.floor(Re.height/i);a>=r?be(M.WIDTH*s/(a-1),M.HEIGHT*n/(r-1)):be(M.WIDTH*(1-n/(r-1)),M.HEIGHT*s/(a-1))})),He())}function Ne(e){if(e){const t=ue.findIndex((t=>t===e));t>-1&&ue.splice(t,1)}}function _e(){oe.updateFades()&&0===ue.length&&T();for(let e=0;e<ue.length;++e)ue[e].update()}function Fe(){fe?oe.render(fe):He()}function He(){if(fe=null,Re=document.getElementById("oware-canvas"),!Re)return;Re.width=Re.height=1;const e=window.devicePixelRatio||1,t=window.innerWidth,s=window.innerHeight;let n=M.WIDTH,i=M.HEIGHT;const a=new DOMMatrix;if(t>=s){let r=1;t<M.WIDTH&&(n=t,r=n/M.WIDTH,i=r*M.HEIGHT),s<i&&(i=s,r=i/M.HEIGHT,n=r*M.WIDTH),a.a=a.d=e*r,a.b=a.c=a.e=a.f=0}else{let r=1;s<M.WIDTH&&(n=s,r=n/M.WIDTH,i=r*M.HEIGHT),t<i&&(i=t,r=i/M.HEIGHT,n=r*M.WIDTH),a.a=a.d=a.e=0,a.b=-e*r,a.c=e*r,a.f=e*n;let o=n;n=i,i=o}Re.style.width=`${Math.floor(n)}px`,Re.style.height=`${Math.floor(i)}px`,Re.width=Math.floor(e*n),Re.height=Math.floor(e*i),fe=Re.getContext("2d"),fe&&(fe.setTransform(a),Re.style.left=(t-n)/2+"px",Re.style.top=(s-i)/2+"px",oe.render(fe))}function Se(){le=new ie(oe),ue.push(le),le.thinkingDoneCallback=()=>Ne(le),f()}function ge(){0==--de&&(We(),he=ae.GAME_OVER)}function ye(){pe.postMessage(new re.V1)}function Ge(){const e=null===Ie?0:Ie.requestID+1,t=ce.children();for(let e=t.length-1;e>=0;--e)e>0&&(t[e].parent=null);Ie=new re.G$(e,t,Ae),Ee=null,De=null,pe.postMessage(Ie)}function Oe(){if(he!==ae.WAITING_FOR_AI)return;if(null===Ie||null===Ee||null===De)return;if(Ie.requestID!==Ee.requestID||Ie.requestID!==De.requestID)return;const t=De.results[Ee.nodeIndex];if(!t)return;switch(le&&(le.stop(),le=null),t.outcome){case e.Jq.DRAW:oe.status=Y.DRAW_FAVORED;break;case e.Jq.A_WON:oe.status=Y.A_FAVORED;break;case e.Jq.B_WON:oe.status=Y.B_FAVORED}Fe();const s=new e.OF(t.bestChild);if(s.parent=ce,ce=s,ce.createSownHouse>=0){he=ae.AI_SOWING;const t=new K(oe,e.J5.B,ce.createSownHouse,ce.createCaptured,me,!1);t.updatesDoneCallback=()=>Ne(t),ue.push(t),f()}else Ce()}function Ce(){he=ae.CAPTURING_REMAINDER,de=2;const t=new ee(oe,e.J5.A,ge);ue.push(t),t.updatesDoneCallback=()=>Ne(t);const s=new ee(oe,e.J5.B,ge);ue.push(s),s.updatesDoneCallback=()=>Ne(s),f()}function me(){if(ce.type!==e.Jq.INTERMEDIATE)ce.createOperation===e.qW.CAPTURED_REMAINDER?Ce():(We(),he=ae.GAME_OVER);else{const t=ce.children();1===t.length&&t[0].createOperation===e.qW.CAPTURED_REMAINDER&&t[0].createSownHouse<0?(ce=t[0],Ce()):(he=ae.WAITING_FOR_HUMAN,Ge())}}function We(){switch(ce.type){case e.Jq.DRAW:oe.status=Y.DRAW;break;case e.Jq.A_WON:oe.status=Y.A_WON;break;case e.Jq.B_WON:oe.status=Y.B_WON}Fe()}async function we(){We(),ce.type===e.Jq.INTERMEDIATE?(he=ae.WAITING_FOR_AI,Se(),Oe()):ce.createOperation===e.qW.CAPTURED_REMAINDER?Ce():(We(),he=ae.GAME_OVER)}function be(t,s){if(t<O.SIZE+O.PADDING/2)s<(O.SIZE+O.PADDING)/2&&Ue(he===ae.GAME_OVER);else if(s>=O.SIZE+O.PADDING/2){const s=Math.floor((t-(O.SIZE+O.PADDING/2))/(O.SIZE+O.PADDING));if(s<0||s>5)return;!function(t){if(he!==ae.WAITING_FOR_HUMAN||null===Ie)return;const s=Ie.nodes;let n=0;e:{for(let e=s.length-1;e>=0;--e)if(s[e].createSownHouse===t){n=e;break e}return}he=ae.HUMAN_SOWING,ce=s[n],ce.type===e.Jq.INTERMEDIATE?function(e){null!==Ie&&(Ee=new re.sS(Ie.requestID,e),null===De?pe.postMessage(Ee):Oe())}(n):ye();const i=new K(oe,e.J5.A,t,ce.createCaptured,we,!0);i.updatesDoneCallback=()=>Ne(i),ue.push(i),f()}(s)}}function Me(){const e=document.getElementById("quit-buttons"),t=document.getElementById("quit-button"),s=document.getElementById("resume-button");e.style.top=e.style.left=e.style.transform=s.style.width=t.style.width="",e.style.display="none";const n=window.innerWidth,i=window.innerHeight;if(e.style.display="block",t.style.width=s.style.width=`${s.getBoundingClientRect().width}px`,n>=i){const t=e.getBoundingClientRect();e.style.left=(n-t.width)/2+"px",e.style.top=(i-t.height)/2+"px"}else{e.style.transform="rotate(-90deg)";const t=e.getBoundingClientRect();e.style.left=(n-t.height)/2+"px",e.style.top=(i-t.width)/2+"px"}}var ve;pe.onmessage=e=>{const t=e.data;var s;t.type===re.Cs.SEARCH_RESPONSE&&(s=t,null!==Ie&&Ie.requestID===s.requestID&&(De=s,Oe()))},function(e){e[e.START=0]="START",e[e.GAME=1]="GAME",e[e.QUIT=2]="QUIT"}(ve||(ve={}));let Pe=ve.START,Be=null,ke=!1;function Ve(t,s){Pe=ve.GAME,Ze(),Te(),function(t,s){ce=new e.OF,oe.reset(),ue.length=0,le=null,de=0,Ae=s,Ie=null,Ee=null,De=null,Fe(),ye(),T(),t===e.J5.A?(ce.createPlayer=e.J5.B,he=ae.WAITING_FOR_HUMAN,Ge()):(ce.createPlayer=e.J5.A,he=ae.WAITING_FOR_AI,Ie=new re.G$(0,[ce],Ae),Ee=new re.sS(0,0),De=null,pe.postMessage(Ie),Se())}(t,s)}function Ue(e){e?Le():(Pe=ve.QUIT,document.getElementById("main-content").innerHTML='\n            <div id="quit-buttons">\n                <button id="quit-button">Quit</button>\n                <button id="resume-button">Resume</button>\n            </div>',document.getElementById("quit-button").addEventListener("click",(e=>Le())),document.getElementById("resume-button").addEventListener("click",(e=>qe())),Me())}function Le(){Pe=ve.START,null!==Be&&"wakeLock"in navigator&&(ke=!1,Be.release().then((()=>{ke||(Be=null)})).catch((e=>{}))),ye(),T(),u()}function qe(){Pe=ve.GAME,Te()}function xe(){switch(Pe){case ve.START:h();break;case ve.GAME:He();break;case ve.QUIT:Me()}}function Ze(){!ke&&null===Be&&"wakeLock"in navigator&&(ke=!0,navigator.wakeLock.request("screen").then((e=>{ke&&(Be=e,Be.addEventListener("release",(()=>{ke||(Be=null)})))})).catch((e=>{})).finally((()=>ke=!1)))}document.addEventListener("DOMContentLoaded",(function(){document.addEventListener("dblclick",(e=>e.preventDefault()),{passive:!1}),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&Pe!==ve.START&&Ze()})),window.addEventListener("resize",xe),u()}))})()})();